# Everything Claude Code — 部署与安装指南

> 版本：1.0
> 日期：2026-02-07
> 项目版本：v1.4.1

---

## 1. 环境要求

### 1.1 必需环境

| 组件 | 最低版本 | 说明 |
|------|---------|------|
| Claude Code CLI | v2.1.0+ | Anthropic 官方 CLI 工具 |
| Node.js | v14+ | 运行 ECC 脚本 |
| Git | 任意版本 | 版本控制 |
| 包管理器 | npm/pnpm/yarn/bun 任一 | 自动检测 |

### 1.2 支持的操作系统

| 操作系统 | 支持状态 | 备注 |
|---------|---------|------|
| Windows 10/11 | ✅ 完全支持 | 路径使用 Node.js 处理 |
| macOS 12+ | ✅ 完全支持 | — |
| Linux (Ubuntu/Debian/etc.) | ✅ 完全支持 | — |

### 1.3 可选环境（MCP 服务器）

| 服务 | 所需凭据 | 用途 |
|------|---------|------|
| GitHub | Personal Access Token | Git 操作、Issue/PR 管理 |
| Supabase | Project Ref + Key | 数据库操作 |
| Vercel | API Token | 部署管理 |
| Railway | API Key | 服务部署 |
| Firecrawl | API Key | Web 爬取 |
| Cloudflare | API Token | Workers/KV/D1/R2 |

---

## 2. 安装方式

### 2.1 方式一：插件市场安装（推荐）

适用于已安装 Claude Code v2.1+ 且支持插件系统的用户。

```bash
# 步骤 1: 从市场添加插件
/plugin marketplace add affaan-m/everything-claude-code

# 步骤 2: 安装插件
/plugin install everything-claude-code@everything-claude-code

# 步骤 3: 手动安装规则（插件系统不分发规则）
# 根据你的主要开发语言选择

# 通用规则（必选）
cp -r everything-claude-code/rules/common/* ~/.claude/rules/

# TypeScript 项目
cp -r everything-claude-code/rules/typescript/* ~/.claude/rules/

# Python 项目
cp -r everything-claude-code/rules/python/* ~/.claude/rules/

# Go 项目
cp -r everything-claude-code/rules/golang/* ~/.claude/rules/

# 步骤 4: 安装钩子（可选）
cp everything-claude-code/hooks/hooks.json ~/.claude/hooks.json

# 步骤 5: 验证安装
/instinct-status
```

### 2.2 方式二：手动安装

适用于需要精细控制安装组件的高级用户。

```bash
# 步骤 1: 克隆仓库
git clone https://github.com/affaan-m/everything-claude-code.git
cd everything-claude-code

# 步骤 2: 安装代理
mkdir -p ~/.claude/agents
cp agents/*.md ~/.claude/agents/

# 步骤 3: 安装命令
mkdir -p ~/.claude/commands
cp commands/*.md ~/.claude/commands/

# 步骤 4: 安装技能
mkdir -p ~/.claude/skills
cp -r skills/* ~/.claude/skills/

# 步骤 5: 安装规则
mkdir -p ~/.claude/rules
cp -r rules/common/* ~/.claude/rules/
# 选择你的语言规则
cp -r rules/typescript/* ~/.claude/rules/  # 或 python/golang

# 步骤 6: 安装钩子（可选）
cp hooks/hooks.json ~/.claude/hooks.json

# 步骤 7: 安装脚本
mkdir -p ~/.claude/scripts
cp -r scripts/* ~/.claude/scripts/

# 步骤 8: 安装 MCP 配置（可选）
cp mcp-configs/mcp-servers.json ~/.claude/mcp-servers.json
# 编辑文件，填入你的 API Key
```

### 2.3 方式三：交互式安装向导

适用于首次使用、希望引导式安装的用户。

```bash
# 在 Claude Code 中执行
/configure-ecc
```

安装向导将：
1. 检测是否已有 ECC 安装
2. 如有旧安装，提供合并/覆盖选项
3. 询问主要开发语言
4. 自动安装对应组件
5. 配置包管理器
6. 验证安装结果

### 2.4 Windows 特殊说明

Windows 用户的 `~/.claude/` 路径对应：

```
C:\Users\<用户名>\.claude\
```

使用 PowerShell 安装：

```powershell
# 创建目录
New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.claude\agents"
New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.claude\commands"
New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.claude\skills"
New-Item -ItemType Directory -Force -Path "$env:USERPROFILE\.claude\rules"

# 复制文件
Copy-Item agents\*.md "$env:USERPROFILE\.claude\agents\"
Copy-Item commands\*.md "$env:USERPROFILE\.claude\commands\"
Copy-Item -Recurse skills\* "$env:USERPROFILE\.claude\skills\"
Copy-Item -Recurse rules\common\* "$env:USERPROFILE\.claude\rules\"
```

---

## 3. 配置指南

### 3.1 包管理器配置

```bash
# 自动检测（推荐）
/setup-pm

# 或手动设置
node scripts/setup-package-manager.js --detect          # 自动检测
node scripts/setup-package-manager.js --project pnpm    # 项目级设置
node scripts/setup-package-manager.js --global pnpm     # 全局设置
```

### 3.2 MCP 服务器配置

编辑 `~/.claude/mcp-servers.json`，填入你的 API 凭据：

```json
{
  "mcpServers": {
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_PERSONAL_ACCESS_TOKEN": "<你的 GitHub PAT>"
      }
    },
    "supabase": {
      "command": "npx",
      "args": ["-y", "@supabase/mcp-server"],
      "env": {
        "SUPABASE_PROJECT_REF": "<你的项目 Ref>",
        "SUPABASE_SERVICE_ROLE_KEY": "<你的 Service Role Key>"
      }
    }
  }
}
```

### 3.3 钩子配置

编辑 `~/.claude/hooks.json`，按需启用/禁用钩子：

```json
{
  "hooks": {
    "SessionStart": [
      {
        "command": "node ~/.claude/scripts/hooks/session-start.js"
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash",
        "command": "node ~/.claude/scripts/hooks/check-console-log.js"
      }
    ]
  }
}
```

### 3.4 用户全局配置

编辑 `~/.claude/CLAUDE.md`，设置个人偏好：

```markdown
# 个人偏好

## 编码风格
- 使用 TypeScript strict mode
- 偏好函数式编程风格
- 测试框架: vitest

## 响应语言
Always respond in Chinese-simplified
```

---

## 4. 升级指南

### 4.1 从旧版本升级

```bash
# 步骤 1: 备份现有配置
cp -r ~/.claude/agents ~/.claude/agents.bak
cp -r ~/.claude/commands ~/.claude/commands.bak
cp -r ~/.claude/skills ~/.claude/skills.bak

# 步骤 2: 拉取最新版本
cd everything-claude-code
git pull origin main

# 步骤 3: 覆盖安装
cp agents/*.md ~/.claude/agents/
cp commands/*.md ~/.claude/commands/
cp -r skills/* ~/.claude/skills/

# 步骤 4: 检查变更日志
# 查看 README.md 中的 What's New 部分

# 步骤 5: 验证
/verify
```

### 4.2 使用交互式升级

```bash
/configure-ecc
# 选择 "升级现有安装"
# 向导将自动处理合并和升级
```

---

## 5. 卸载指南

```bash
# 移除所有 ECC 组件
rm -rf ~/.claude/agents/
rm -rf ~/.claude/commands/
rm -rf ~/.claude/skills/
rm -rf ~/.claude/rules/
rm ~/.claude/hooks.json
rm -rf ~/.claude/scripts/

# 保留用户个人配置
# ~/.claude/CLAUDE.md 不删除
```

---

## 6. 故障排查

### 6.1 常见问题

| 问题 | 原因 | 解决方案 |
|------|------|---------|
| 命令不可用 | 命令文件未安装到正确路径 | 检查 `~/.claude/commands/` 目录 |
| 代理无响应 | 代理 frontmatter 格式错误 | 运行 `node scripts/ci/validate-agents.js` |
| 钩子不触发 | hooks.json 格式错误或路径错误 | 运行 `node scripts/ci/validate-hooks.js` |
| 包管理器检测错误 | 缺少锁文件 | 运行 `/setup-pm` 手动配置 |
| Windows 路径错误 | 使用了 Unix 路径分隔符 | 确保使用 Node.js 脚本而非 bash |
| MCP 服务器连接失败 | API Key 未配置 | 检查 `mcp-servers.json` 中的环境变量 |

### 6.2 诊断命令

```bash
# 检查安装完整性
ls ~/.claude/agents/     # 应有 13 个 .md 文件
ls ~/.claude/commands/   # 应有 30+ 个 .md 文件
ls ~/.claude/skills/     # 应有 30+ 个目录

# 验证配置格式
node scripts/ci/validate-agents.js
node scripts/ci/validate-commands.js
node scripts/ci/validate-hooks.js
node scripts/ci/validate-rules.js
node scripts/ci/validate-skills.js

# 运行测试套件
node tests/run-all.js

# 检查包管理器
node scripts/setup-package-manager.js --detect
```

### 6.3 获取帮助

- **GitHub Issues：** 报告问题和功能请求
- **CONTRIBUTING.md：** 贡献指南和开发环境搭建
- **the-shortform-guide.md：** 快速入门指南
- **the-longform-guide.md：** 高级使用技巧
